// expedientes.js

document.addEventListener("DOMContentLoaded", function () {
  const form = document.getElementById("form-expediente");
  const tabla = document.getElementById("tabla-expedientes");

  function cargarExpedientes() {
    tabla.innerHTML = "";
    const expedientes = JSON.parse(localStorage.getItem("expedientes")) || [];

    expedientes.forEach((exp, index) => {
      const fila = document.createElement("tr");
      fila.innerHTML = `
        <td>${exp.numero}</td>
        <td>${exp.caratula}</td>
        <td>${exp.juzgado}</td>
        <td>${exp.fecha}</td>
        <td>${exp.archivoNombre || "Sin archivo"}</td>
        <td><button onclick="eliminarExpediente(${index})">Eliminar</button></td>
      `;
      tabla.appendChild(fila);
    });
  }

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    const numero = document.getElementById("numero").value;
    const caratula = document.getElementById("caratula").value;
    const juzgado = document.getElementById("juzgado").value;
    const fecha = document.getElementById("fecha").value;
    const archivo = document.getElementById("archivo").files[0];

    const nuevoExpediente = {
      numero,
      caratula,
      juzgado,
      fecha,
      archivoNombre: archivo ? archivo.name : null,
    };

    const expedientes = JSON.parse(localStorage.getItem("expedientes")) || [];
    expedientes.push(nuevoExpediente);
    localStorage.setItem("expedientes", JSON.stringify(expedientes));

    form.reset();
    cargarExpedientes();
  });

  window.eliminarExpediente = function (index) {
    const expedientes = JSON.parse(localStorage.getItem("expedientes")) || [];
    expedientes.splice(index, 1);
    localStorage.setItem("expedientes", JSON.stringify(expedientes));
    cargarExpedientes();
  };

  cargarExpedientes();
});
